dynamic_widget=function(){var api_url="http://108.170.11.234:190/list_api.php",current_index=0,widget_data={},widget_items=[],widget_conf=JSON.parse(decodeURIComponent(location.search.substr(1))),tries=0;function get_data(){if(typeof widget_conf.category=="undefined"||["finance","nba","college_basketball","weather","crime","demographics","politics","disaster"].indexOf(widget_conf.category)==-1){widget_conf.category="finance"}var random=Math.floor(Math.random()*10);if(typeof widget_conf.rand!="undefined"&&tries==0){random=widget_conf.rand}var xmlhttp;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==XMLHttpRequest.DONE){if(xmlhttp.status==200){widget_data=JSON.parse(xmlhttp.responseText);widget_items=widget_data.l_data;if(document.readyState=="complete"){create_widget()}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",create_widget)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState=="complete"){create_widget()}})}}else{var msg=xmlhttp.statusText;if(xmlhttp.status==500){try{var json_msg=JSON.parse(xmlhttp.responseText);msg=json_msg.message}catch(e){console.log("No JSON message")}}msg="HTTP Error ("+xmlhttp.status+"): "+msg;console.log(msg);tries++;if(tries>10){throw msg}setTimeout(get_data,1e3)}}};xmlhttp.open("GET",api_url+"?partner="+(typeof widget_conf.dom!="undefined"?widget_conf.dom:"")+"&cat="+widget_conf.category+"&rand="+random,true);xmlhttp.send()}function create_widget(){if(typeof dataLayer!="undefined"){dataLayer.push({event:"widget-title",eventAction:dynamic_widget.get_title()})}if(widget_conf.category=="politics"){var letter="d";if(widget_data.l_title.indexOf("Republican")!=-1){letter="r"}else if(widget_data.l_title.indexOf("Independent")!=-1){letter="i"}var css_url="../css/dynamic_widget_politics_"+letter+".css";var link=document.createElement("link");link.href=css_url;link.type="text/css";link.rel="stylesheet";link.media="screen,print";document.getElementsByTagName("head")[0].appendChild(link)}document.getElementById("title").innerHTML=widget_data.l_title;switch(widget_conf.category){case"nba":if(widget_conf.remn=="true"){var base_url="http://www.hoopsloyal.com/NBA/widget-list"}else{var base_url="http://www.myhoopszone.com/"+widget_conf.dom+"/NBA/w-list"}break;case"college_basketball":if(widget_conf.remn=="true"){var base_url="http://www.hoopsloyal.com/NCAA/widget-list"}else{var base_url="http://www.myhoopszone.com/"+widget_conf.dom+"/NCAA/w-list"}break;case"finance":if(widget_conf.remn=="true"){var base_url="http://www.investkit.com/widget-list"}else{var base_url="http://www.myinvestkit.com/"+widget_conf.dom+"/w-list"}break;default:if(widget_conf.remn=="true"){var base_url="http://www.joyfulhome.com/widget-list"}else{var base_url="http://www.myhousekit.com/"+widget_conf.dom+"/w-list"}}document.getElementById("list-link").href=base_url+"?tw="+widget_data.l_param+"&sw="+widget_data.l_sort+"&input="+widget_data.l_input;display_item()}function display_item(){var current_data=widget_items[current_index];if(widget_conf.remn=="true"){current_data.li_url=current_data.li_primary_url}else{current_data.li_url=current_data.li_partner_url.replace("{partner}",widget_conf.dom)}document.getElementById("line1").innerHTML=current_data.li_title;document.getElementById("desc").innerHTML=current_data.li_str;document.getElementById("num").innerHTML="#"+current_data.li_rank;document.getElementById("line2").innerHTML=current_data.li_sub_txt;document.getElementById("mainimg").src=current_data.li_img;document.getElementById("mainurl").href=current_data.li_url;document.getElementById("line1").href=current_data.li_url;if(current_data.li_subimg!==false){if(widget_conf.remn=="true"){var sub_li_url=current_data.li_subimg.primary_url}else{var sub_li_url=current_data.li_subimg.partner_url.replace("{partner}",widget_conf.dom)}var carousel=document.getElementById("carousel");if(carousel.className.indexOf("two")==-1){carousel.className+=" two"}document.getElementById("subimg").src=current_data.li_subimg.img;document.getElementById("suburl").href=sub_li_url}}function next_item(){current_index++;if(current_index==widget_items.length){current_index=0}display_item();dataLayer.push({event:"nav-right",eventAction:dynamic_widget.get_title()})}function prev_item(){current_index--;if(current_index<0){current_index=widget_items.length-1}display_item();dataLayer.push({event:"nav-left",eventAction:dynamic_widget.get_title()})}function get_title(){return widget_conf.dom+":"+widget_conf.category+":"+(widget_data.l_sort==null?widget_data.l_param:widget_data.l_sort)+":"+widget_data.l_title}get_data();function set_home_link(){switch(widget_conf.category){case"finance":var url="http://www.investkit.com/";if(widget_conf.remn!="true"){url="http://www.myinvestkit.com/"+widget_conf.dom+"/"}break;case"nba":var url="http://www.hoopsloyal.com/NBA";if(widget_conf.remn!="true"){url="http://www.myhoopszone.com/"+widget_conf.dom+"/NBA"}break;case"college_basketball":var url="http://www.hoopsloyal.com/NCAA";if(widget_conf.remn!="true"){url="http://www.myhoopszone.com/"+widget_conf.dom+"/NCAA"}break;default:var url="http://www.joyfulhome.com/";if(widget_conf.remn!="true"){url="http://www.myhousekit.com/"+widget_conf.dom+"/"}break}document.getElementById("homelink").href=url}if(document.readyState=="complete"){set_home_link()}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",set_home_link)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){set_home_link()}})}return{next_item:next_item,prev_item:prev_item,get_title:get_title}}();
