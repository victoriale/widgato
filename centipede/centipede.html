<!doctype html>
<html lang=en>

<head>
    <title>Centipede Widget</title>
    <meta charset=utf-8>
    <base target=_blank>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
<script type=text/javascript>
//inject HTML and CSS structure
  document.write(`
    <style>
    body {
      border: none;
      margin: 0;
      padding: 0;
      -webkit-overflow-scrolling: auto;
    }
    .icon {
      background-position: 50%;
      background-repeat: no-repeat;
      height: 40px;
      width: 40px;
    }
    .wrapper {
      position: absolute;
      overflow: hidden;
      width: 320px;
      height: 270px;
      background-color: #f7f7f7;
    }
    .edge_shader {
      position: absolute;
      right:-5px;
      top:0;
      width: 3px;
      height: 100%;
      box-shadow:  -5px 0 10px rgba(0,0,0,0.8);
      z-index: 999;
      transition: opacity 0.2s ease-in-out;
    }
    .helper {
      position: absolute;
      right:0px;
      left:0px;
      width: 100%;
      padding: 5px 10px;
      font-family: lato;
      /*font-weight: 300;*/
      font-size: 12px;
      color: black;
      background-color: rgba(247, 247, 247, 0.9);
      box-shadow: 0 2px 2px 0 rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.09);
      opacity: 1;
      transition: opacity 0.2s ease-in-out;
      z-index: 9999;
    }
    .helper2 {
      pointer-events: none;
      position: absolute;
      right:0px;
      top: 50%;
      transform: translateY(-50%);
      padding: 10px 5px 10px 10px;
      font-family: lato;
      /*font-weight: 300;*/
      font-size: 20px;
      color: black;
      border-top-left-radius: 30px;
      border-bottom-left-radius: 30px;
      overflow: hidden;
      background-color: rgba(247, 247, 247, 0.85);
      box-shadow: 0 2px 2px 0 rgba(0,0,0,0.26), 0 0 0 1px rgba(0,0,0,0.09);
      opacity: 1;
      transition: opacity 0.2s ease-in-out;
      z-index: 9999;
    }
    .helper2 .icon {
      animation:swipe 2s infinite;
    }
    @keyframes swipe {
      0%{
        -webkit-transform: translateX(50px);
        -moz-transform: translateX(50px);
        -ms-transform: translateX(50px);
        -o-transform: translateX(50px);
        transform: translateX(50px);
        opacity: 0.01;
      }
      50% {
        -webkit-transform: translateX(0px);
        -moz-transform: translateX(0px);
        -ms-transform: translateX(0px);
        -o-transform: translateX(0px);
        transform: translateX(0px);
        opacity:1;
      }
      100% {
        -webkit-transform: translateX(-50px);
        -moz-transform: translateX(-50px);
        -ms-transform: translateX(-50px);
        -o-transform: translateX(-50px);
        transform: translateX(-50px);
        opacity:0.01;
      }
    }
    .worm {
      position: absolute;
      width: 320px;
      height: 270px;
      overflow-x: scroll;
      overflow-y: hidden;
      white-space: nowrap;
      background-color: #f7f7f7;
      animation:bounce 2s 1;
    }
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        -webkit-transform: translateX(0);
        -moz-transform: translateX(0);
        -ms-transform: translateX(0);
        -o-transform: translateX(0);
        transform: translateX(0); }
      40% {
        -webkit-transform: translateX(30px);
        -moz-transform: translateX(30px);
        -ms-transform: translateX(30px);
        -o-transform: translateX(30px);
        transform: translateX(30px); }
      60% {
        -webkit-transform: translateX(15px);
        -moz-transform: translateX(15px);
        -ms-transform: translateX(15px);
        -o-transform: translateX(15px);
        transform: translateX(15px); } }
    .worm_block {
      display: inline-block;
      height: 250px;
      margin-top: 10px;
    }
    .worm_block:last-of-type {
      margin-right: 10px;
    }
    .list_item {
      position: relative;
      display: inline-block;
      height: 90%;
      width: 145px;
      margin-left:5px;
      background-color: white;
      border-radius: 2px;
      box-shadow: 0 2px 2px 0 rgba(0,0,0,0.16), 0 0 0 1px rgba(0,0,0,0.08);
    }
    .ad_item {
      position: relative;
      height: 100%;
      width: 300px;
      margin-left:5px;
    }
    .profile_image_div {
      width: 90px;
      height: 90px;
      margin: 5% 20%;
      display: block;
      position: absolute;
    }
    .profile_image {
      position: absolute;
      width: 100%;
      top: 50%;
      transform: translateY(-50%);
    }
    .info {
      width: 100%;
      position: absolute;
      top: 100px;
      font-family: lato;
      text-align: center;
    }
    .name {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .symbl, .location {
      font-size: 12px;
      color: #bebebe;
    }
    .location {
      margin-bottom: 5px;
    }
    .value {
      font-size: 32px;
      color: #545454;
      margin-bottom: 5px;
    }
    .stat_type {
      font-size: 12px;
      color: #666666;
    }

    </style>
    <div class="wrapper">
      <div class="helper" id="helper">
        Companies With The largest Market Cap
      </div>
      <div class="helper2" id="helper2">
        <div class="icon swipe_right" style="background-image:url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDAwMDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTM2LDMxLjM0NWMwLTAuOTEyLDAtMS43NzgsMC0yLjU5MWMtMi0xLjQ1OC0zLjQwMi0zLjgxNC0zLjQwMi02LjQ3NmMwLTQuNDE2LDMuNTUtOC4wMSw3Ljk2NS04LjAxICAgYzQuNDE4LDAsNy44ODEsMy41OTQsNy44ODEsOC4wMWMwLDIuNjYyLTEuNDQzLDUuMDE5LTMuNDQzLDYuNDc3djIuNTljMy0xLjcwNCw1LjYzMS01LjEyNSw1LjYzMS05LjA2NiAgIGMwLTUuNjM1LTQuNTMxLTEwLjIxOS0xMC4xNjYtMTAuMjE5cy0xMC4xMDMsNC41ODQtMTAuMTAzLDEwLjIxOUMzMC4zNjIsMjYuMjIxLDMzLDI5LjY0MiwzNiwzMS4zNDV6Ii8+PHBhdGggZmlsbD0iIzAwMDAwMCIgZD0iTTcwLjA3LDQzLjExOGgtMi43NjJjLTAuNzc3LDAtMS41NzQsMC4xODgtMi4yNzUsMC41M2MtMC4zNjItMi4wNzUtMi4xNzYtMy42NTgtNC4zNTMtMy42NThoLTIuNzYzICAgYy0wLjkwOSwwLTEuNzU5LDAuMjc4LTIuNDYyLDAuNzUyYy0wLjYwOC0xLjcxNS0yLjI0Ni0yLjk0NC00LjE2NS0yLjk0NGgtMi43NjNjLTAuODA1LDAtMS41NTksMC4yMTYtMi4yMSwwLjU5M1YyMi4yNzggICBjMC0zLjE5OC0yLjYwMi01LjgtNS44LTUuOGMtMy4xOTYsMC01LjgsMi42MDItNS44LDUuOHYzMC41OTFjLTEuMjM5LDAuNTg5LTIuMzg5LDEuMzgxLTMuMzg5LDIuMzc5bC0yLjI2NCwyLjI2NSAgIGMtNC43MzksNC43MzktNC43MzksMTIuNDQ3LDAsMTcuMTg2bDYuMzEsNi4zMTFjMC4zMSwwLjMxLDAuNjM1LDAuNTk2LDAuOTcsMC44NjdjMi4xMDMsMy42MjEsNi4wMzIsNi4wNjQsMTAuNTI1LDYuMDY0aDE1LjQ2NyAgIGM2LjcwMSwwLDEyLjE1LTUuNDI5LDEyLjE1LTEyLjEwMlY0Ny41MzZDNzQuNDg4LDQ1LjEsNzIuNTA3LDQzLjExOCw3MC4wNyw0My4xMTh6IE03Mi4yNzksNzUuODM5ICAgYzAsNS40NTQtNC40NTksOS44OTItOS45NDEsOS44OTJINDYuODcxYy0xLjgyMSwwLTMuNTI1LTAuNDk3LTQuOTk1LTEuMzUzYy0xLjIxOS0wLjcyOS0yLjU3Ny0xLjc4OC0zLjgyLTMuOTgxICAgYy0wLjcxNy0xLjM2NS0xLjEyNy0yLjkxNC0xLjEyNy00LjU1OGMwLTAuNjEtMC40OTUtMS4xMDUtMS4xMDQtMS4xMDVjLTAuNjExLDAtMS4xMDUsMC40OTUtMS4xMDUsMS4xMDUgICBjMCwwLjUwMywwLjAzNSwwLjk5NywwLjA5NSwxLjQ4MmwtNC4xODYtNC4xODZjLTMuODc2LTMuODc2LTMuODc2LTEwLjE4NCwwLTE0LjA2MWwyLjI2NS0yLjI2NCAgIGMwLjU1Ny0wLjU1NywxLjE3My0xLjAyOSwxLjgyNi0xLjQzNHY3LjU2N2MwLDAuNjExLDAuNDk0LDEuMTA1LDEuMTA1LDEuMTA1YzAuNjA5LDAsMS4xMDQtMC40OTQsMS4xMDQtMS4xMDVWMjIuMjc4ICAgYzAtMS45NzksMS42MS0zLjU5MSwzLjU5LTMuNTkxYzEuOTgsMCwzLjU5MSwxLjYxMiwzLjU5MSwzLjU5MXYyOC4zNzhjMCwwLjYxMSwwLjQ5NCwxLjEwNSwxLjEwNCwxLjEwNSAgIGMwLjYwOSwwLDEuMTA0LTAuNDk0LDEuMTA0LTEuMTA1di04LjQ0YzAtMS4yMTcsMC45OTEtMi4yMDgsMi4yMS0yLjIwOGgyLjc2M2MxLjIxNywwLDIuMjA5LDAuOTkxLDIuMjA5LDIuMjA4djguNDUyICAgYzAsMC42MSwwLjQ5MywxLjEwNCwxLjEwNCwxLjEwNGMwLjYwOSwwLDEuMTA1LTAuNDkzLDEuMTA1LTEuMTA0di02LjI1OWMwLTEuMjE3LDAuOTktMi4yMDksMi4yMDgtMi4yMDloMi43NjMgICBjMS4yMTgsMCwyLjIwOSwwLjk5MiwyLjIwOSwyLjIwOXY2LjI0N2MwLDAuNjExLDAuNDk0LDEuMTA1LDEuMTA1LDEuMTA1YzAuNjA4LDAsMS4xMDQtMC40OTQsMS4xMDQtMS4xMDV2LTQuMDA1ICAgYzAtMC42NDQsMS4xMzctMS4zMjQsMi4yMS0xLjMyNGgyLjc2MmMxLjIxOCwwLDIuMjA5LDAuOTkxLDIuMjA5LDIuMjA5Vjc1LjgzOXoiLz48cGF0aCBmaWxsPSIjMDAwMDAwIiBkPSJNNjIuOTEyLDY4SDQ5LjAwOWwxLjQyOC0xLjM0OGMwLjQzMi0wLjQzMiwwLjQzMi0xLjA5LDAtMS41MjFjLTAuNDMyLTAuNDMzLTEuMTMxLTAuNDEyLTEuNTYyLDAuMDIgICBsLTMuMzExLDMuMzIxYy0wLjEwMywwLjEwMi0wLjE4NSwwLjIyOS0wLjI0MSwwLjM2NGMtMC4wNTYsMC4xMzQtMC4wODYsMC4yNzktMC4wODYsMC40MjdzMC4wMywwLjI5NCwwLjA4NiwwLjQyNyAgIGMwLjA1MiwwLjEyNCwwLjEyOSwwLjIzMywwLjIyLDAuMzI5YzAuMDA4LDAuMDA4LDAuMDExLDAuMDIxLDAuMDE5LDAuMDI4bDMuMzEzLDMuMzEzYzAuMjE1LDAuMjE2LDAuNDk4LDAuMzIzLDAuNzgyLDAuMzIzICAgYzAuMjgxLDAsMC41NjQtMC4xMDcsMC43OC0wLjMyM2MwLjQzMi0wLjQzMiwwLjQzMi0xLjMxNSwwLTEuNzQ3TDQ5LjAwNyw3MGgxMy45MDVjMC42MSwwLDEuMTA0LTAuMzksMS4xMDQtMC45OTkgICBDNjQuMDE3LDY4LjM5LDYzLjUyMiw2OCw2Mi45MTIsNjh6Ii8+PC9nPjwvc3ZnPg==);"></div>
      </div>
      <div class="edge_shader" id="edge_shader"></div>
    <div class="worm" id="worm">
      <div class="worm_block">
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/apple.png">
          </div>
          <div class="info">
            <div class="name">
              Apple, Inc.
            </div>
            <div class="symbl">
              NASDAQ:AAPL
            </div>
            <div class="location">
              Cupertino, California
            </div>
            <div class="value">
              736.9B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
      </div>
      <div class="worm_block">
        <div class="ad_item">
          <img src="img/ads/ad2.jpg">
        </div>
      </div>
      <div class="worm_block">
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/alphabet.png">
          </div>
          <div class="info">
            <div class="name">
              Alphabet, Inc.
            </div>
            <div class="symbl">
              NASDAQ:GOOGL
            </div>
            <div class="location">
              Mountain View, California
            </div>
            <div class="value">
              593.1B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/microsoft.jpg">
          </div>
          <div class="info">
            <div class="name">
              Microsoft
            </div>
            <div class="symbl">
              NASDAQ:MSFT
            </div>
            <div class="location">
              Redmond, Washington
            </div>
            <div class="value">
              500.4B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
        <!-- <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/alphabet.png">
          </div>
          <div class="info">
            <div class="name">
              Amazon, Inc.
            </div>
            <div class="symbl">
              NASDAQ:AMZN
            </div>
            <div class="location">
              Seattle, Washington
            </div>
            <div class="value">
              407B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div> -->
      </div>
      <div class="worm_block">
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/alphabet.png">
          </div>
          <div class="info">
            <div class="name">
              Alphabet, Inc.
            </div>
            <div class="symbl">
              NASDAQ:GOOGL
            </div>
            <div class="location">
              Mountain View, California
            </div>
            <div class="value">
              593.1B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/microsoft.jpg">
          </div>
          <div class="info">
            <div class="name">
              Microsoft
            </div>
            <div class="symbl">
              NASDAQ:MSFT
            </div>
            <div class="location">
              Redmond, Washington
            </div>
            <div class="value">
              500.4B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
        <!-- <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/alphabet.png">
          </div>
          <div class="info">
            <div class="name">
              Amazon, Inc.
            </div>
            <div class="symbl">
              NASDAQ:AMZN
            </div>
            <div class="location">
              Seattle, Washington
            </div>
            <div class="value">
              407B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div> -->
      </div>
      <div class="worm_block">
        <div class="ad_item">
          <img src="img/ads/ad1.gif">
        </div>
      </div>
      <div class="worm_block">
        <div class="list_item">
          <div class="profile_image_div">
            <img class="profile_image" src="img/logos/facebook.png">
          </div>
          <div class="info">
            <div class="name">
              Facebook, Inc.
            </div>
            <div class="symbl">
              NASDAQ:FB
            </div>
            <div class="location">
              Menlo Park, CA
            </div>
            <div class="value">
              403.8B
            </div>
            <div class="stat_type">
              Current Market Cap
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
    `);
    //inject Google font CSS
    var link = document.createElement( "link" );
    link.href = "http://fonts.googleapis.com/css?family=Lato:400,300,100,700,900";
    link.type = "text/css";
    link.rel = "stylesheet";
    link.media = "screen,print";
    document.getElementsByTagName( "head" )[0].appendChild( link );

  //begin centipede logic
  //initial variable declaration
  var helper = document.getElementById('helper');
  var helper2 = document.getElementById('helper2');
  var wormBlocks = document.getElementsByClassName('worm_block');
  var worm = document.getElementById('worm');
  var shader = document.getElementById('edge_shader');
  var position;
  var currentBlock = 0;
  var isScrolling = false;
  var scrollingTimout;
  var scrollTo = 0;
  var scrollIncrements = 0;

  //initial event listeners declaration
  worm.addEventListener("scroll", onSwipe);
  function onSwipe(e) {
    isScrolling = true; //will return true or false based on whether the user is currently scrolling or not

    // set visibility of helper and list title, based on scroll position
    if (this.scrollLeft > 20) {
      helper2.style.opacity = '0';
    }
    else {
      helper.style.opacity = '1';
      helper2.style.opacity = '1';
    }
    if ((this.scrollLeft + this.offsetWidth) >= (this.scrollWidth - 20)) {
      shader.style.opacity = '0';
    }
    else {
      shader.style.opacity = '1';
    }
    clearTimeout(scrollingTimout);
    scrollingTimout = setTimeout(function(){ // wait till scroll is finished and set flag as false
      isScrolling = false; //will return true or false based on whether the user is currently scrolling or not
    }, 250);
  }
  worm.addEventListener("touchend", onFingerUp);
  function onFingerUp(e) {
    if (isScrolling == false) {
      setScroll();
    }
    else {
      var setScrollInterval = setInterval(function(){
        if (isScrolling == false) {
          setScroll();
          clearTimeout(setScrollInterval);
        }
      }, 250);
    }
  }

  //logic to snap scrolled block into view, when user scroll has ended
  function setScroll() {
    for (i = 0; i < wormBlocks.length;  i++) {
      if ((worm.scrollLeft + 180) >= wormBlocks[i].offsetLeft && (worm.scrollLeft + 180) <= (wormBlocks[i].offsetLeft + wormBlocks[i].offsetWidth) && worm.scrollLeft > 20) {
        //if user has swiped past the halfway mark on the next block, advance blocks to the one user has scrolled to. Otherwise, reset blocks back to starting point of swipe
        scrollTo = wormBlocks[i].offsetLeft - 5;
        if (worm.scrollLeft < scrollTo) {
          scrollIncrements = 1;
        }
        else {
          scrollIncrements = -1;
        }
        var setSmoothScrollInterval = setInterval(function(){
          var marginOfError = 0;
          if (worm.scrollLeft < (scrollTo - marginOfError) || worm.scrollLeft > (scrollTo + marginOfError)) {
            //if within margin of error of target, end scroll
            if (i == (wormBlocks.length - 1)) {
              clearTimeout(setSmoothScrollInterval);
            }
            else {
              worm.scrollLeft = worm.scrollLeft + scrollIncrements;
            }
          }
          else {
            clearTimeout(setSmoothScrollInterval);
          }
        }, 5);
        currentBlock = i;
        if (wormBlocks[i].getElementsByClassName("ad_item").length >= 1) { //hide title if ad is current item in view
          helper.style.opacity = '0';
        }
        else {
          helper.style.opacity = '1';
        }
        return;
      }
      else if (worm.scrollLeft < 20) { // special logic for first list item
        scrollTo = 0;
        if (worm.scrollLeft < scrollTo) {
          scrollIncrements = 1;
        }
        else {
          scrollIncrements = -1;
        }
        var setSmoothScrollInterval = setInterval(function(){
          var marginOfError = 0;
          if (worm.scrollLeft < (scrollTo - marginOfError) || worm.scrollLeft > (scrollTo + marginOfError)) {
            if (i == (wormBlocks.length - 1)) {
              clearTimeout(setSmoothScrollInterval);
            }
            else {
              worm.scrollLeft = worm.scrollLeft + scrollIncrements;
            }
          }
          else {
            clearTimeout(setSmoothScrollInterval);
          }
        }, 15);
        currentBlock = 0;
        return;
      }
    }
    // if ((currentBlock + 1) <= wormBlocks.length) {
    //   worm.scrollLeft = wormBlocks[currentBlock + 1].offsetLeft - 5;
    //   currentBlock = (currentBlock + 1);
    // }
  }

</script>
</body>
</html>
